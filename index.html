<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokédex - Encuentra tu Pokémon</title>
    <style>
       
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@300;400;600;700&family=Orbitron:wght@400;700;900&display=swap');

        :root {
            --type-normal: #A8A77A;
            --type-fire: #EE8130;
            --type-water: #6390F0;
            --type-electric: #F7D02C;
            --type-grass: #7AC74C;
            --type-ice: #96D9D6;
            --type-fighting: #C22E28;
            --type-poison: #A33EA1;
            --type-ground: #E2BF65;
            --type-flying: #A98FF3;
            --type-psychic: #F95587;
            --type-bug: #A6B91A;
            --type-rock: #B6A136;
            --type-ghost: #735797;
            --type-dragon: #6F35FC;
            --type-dark: #705746;
            --type-steel: #B7B7CE;
            --type-fairy: #D685AD;

           
            --bg-dark-1: #0f1724;
            --bg-dark-2: #071029;
            --accent-yellow: #ffcb05;
            --accent-red: #ff4655;
            --glass-effect: rgba(255, 255, 255, 0.04);
        }

        /* Reset y estilos base */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(180deg, var(--bg-dark-1), var(--bg-dark-2));
            color: #e6eef8;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            padding: 20px;
            background-image: url('img/fondo.jpg');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            background-attachment: fixed;
            position: relative;
        }

        /* Overlay oscuro sobre la imagen de fondo para mejor legibilidad */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(7, 16, 41, 0.75);
            backdrop-filter: blur(2px);
            z-index: -1;
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px;
            margin-bottom: 60px;
            animation: fadeInDown 0.6s ease-out;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            max-width: 500px;
        }

        /* Logo Pokémon */
        #logo {
            width: 260px;
            filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6));
            transition: transform 0.3s ease;
        }

        #logo:hover {
            transform: scale(1.05) rotate(-2deg);
        }

        /* Pokébola */
        #pokebola {
            width: 80px;
            filter: drop-shadow(0 6px 18px rgba(0, 0, 0, 0.6));
            border-radius: 50%;
            transition: transform 0.3s ease;
            animation: float 3s ease-in-out infinite;
        }

        #pokebola:hover {
            transform: rotate(360deg);
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        input[type="text"] {
            flex: 1;
            height: 44px;
            font-size: 15px;
            padding: 8px 16px;
            border-radius: 12px;
            border: 2px solid rgba(255, 203, 5, 0.3);
            background: rgba(255, 255, 255, 0.95);
            color: #000000;
            outline: none;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            border-color: var(--accent-yellow);
            box-shadow: 0 0 0 3px rgba(255, 203, 5, 0.2);
            transform: translateY(-2px);
        }

        input[type="text"]::placeholder {
            color: rgba(0, 0, 0, 0.5);
            font-size: 14px;
        }

        /* Botón de búsqueda */
        button {
            height: 44px;
            font-size: 15px;
            padding: 8px 24px;
            cursor: pointer;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--accent-yellow), #ffa500);
            color: #000000;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            box-shadow: 0 6px 20px rgba(255, 203, 5, 0.4), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 203, 5, 0.6);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 4px 12px rgba(255, 203, 5, 0.4);
        }

        main.contenedor {
            max-width: 1200px;
            margin: 30px auto;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-auto-rows: 1fr;
            gap: 24px;
            padding: 0 16px 60px;
            align-items: stretch;
            animation: fadeInUp 0.8s ease-out;
        }

        .card {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            padding: 24px;
            border-radius: 20px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04));
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(2, 6, 23, 0.7),
                        0 0 40px rgba(255, 70, 85, 0.1);
            backdrop-filter: blur(10px) saturate(150%);
            transition: all 0.3s cubic-bezier(0.2, 0.9, 0.3, 1);
            overflow: hidden;
            min-height: 420px;
            height: 100%;
            grid-column: 1 / 2;
        }

        .card::before {
            content: '';
            position: absolute;
            top: -40%;
            left: -20%;
            width: 160%;
            height: 80%;
            background: radial-gradient(closest-side, rgba(255, 203, 5, 0.15), transparent 60%);
            transform: rotate(-12deg);
            pointer-events: none;
            mix-blend-mode: screen;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 70px rgba(2, 6, 23, 0.8),
                        0 0 60px rgba(255, 203, 5, 0.2);
        }

        /* Nombre del Pokémon */
        .card h1 {
            margin: 0;
            font-family: 'Press Start 2P', monospace;
            font-size: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #fff;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.8),
                         0 0 10px rgba(255, 203, 5, 0.5);
            text-align: center;
            padding: 0 8px;
            position: relative;
            z-index: 1;
        }

        /* Número grande centrado (columna central) */
        .center-info {
            text-align: center;
            margin-bottom: 12px;
        }

        .big-id {
            font-family: 'Press Start 2P', monospace;
            font-size: 96px;
            color: var(--accent-yellow);
            letter-spacing: 4px;
            margin: 8px 0;
            text-shadow: 0 6px 24px rgba(0,0,0,0.6), 0 0 16px rgba(255,203,5,0.25);
        }

        .center-subtitle {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            color: #ffffff;
            margin: 6px 0 18px 0;
        }

        /* Información básica del Pokémon */
        .card h3 {
            margin: 4px 0;
            font-size: 14px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            color: rgb(255, 255, 255);
            text-align: center;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
            position: relative;
            z-index: 1;
        }

        /* Imagen del Pokémon */
        #img {
            width: 280px;
            height: 280px;
            object-fit: contain;
            filter: drop-shadow(0 20px 40px rgba(4, 10, 24, 0.8)) saturate(130%);
            transition: transform 0.3s ease;
            border-radius: 14px;
            padding: 10px;
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .card:hover #img {
            transform: scale(1.1) rotate(5deg);
        }

        /* SECCIÓN DE INFORMACIÓN */
        .informacion {
            grid-column: 2 / 3;
            min-height: 420px;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 24px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(2, 6, 23, 0.7),
                        0 0 40px rgba(255, 70, 85, 0.1);
            backdrop-filter: blur(10px) saturate(150%);
            text-align: center;
            color: #e6eef8;
        }

        /* Mid column glass panel stronger blur */
        .info-grid .info-section {
            background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
            backdrop-filter: blur(6px) saturate(140%);
            border: 1px solid rgba(255,255,255,0.06);
        }

        /* Grid de información */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 16px;
            width: 100%;
            height: 100%;
            flex: 1;
        }

        .info-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.15));
            padding: 16px;
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .info-section:nth-child(1) {
            grid-column: 1 / 2;
            grid-row: 1 / 2;
        }

        .info-section:nth-child(2) {
            grid-column: 2 / 3;
            grid-row: 1 / 2;
        }

        .info-section:nth-child(3) {
            grid-column: 1 / -1;
            grid-row: 2 / 3;
        }

        /* Títulos de sección */
        .section-title {
            font-family: 'Press Start 2P', monospace;
            font-size: 11px;
            margin-bottom: 12px;
            color: #fff;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
        }

        /* Contenedores de tipos y debilidades */
        #tipos,
        #debilidades {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }

        /* Badges de tipos y debilidades */
        .type-badge,
        .weakness-badge {
            font-family: 'Orbitron', sans-serif;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 700;
            border-radius: 999px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .type-badge:hover,
        .weakness-badge:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        }

        /* Contenedor de movimientos */
        .moves-container {
            width: 100%;
            max-height: 180px;
            overflow-y: auto;
            padding-right: 4px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .moves-container::-webkit-scrollbar {
            width: 6px;
        }

        .moves-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .moves-container::-webkit-scrollbar-thumb {
            background: rgba(255, 203, 5, 0.5);
            border-radius: 10px;
        }

        .moves-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 203, 5, 0.8);
        }

       
        .move-item {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-transform: capitalize;
            transition: all 0.2s ease;
        }

        .move-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }


        .estadisticas {
            grid-column: 3 / 4;
            min-height: 420px;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 24px;
            background: linear-gradient(180deg, rgba(0,0,0,0.28), rgba(0,0,0,0.18));
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(2, 6, 23, 0.7),
                        0 0 40px rgba(255, 70, 85, 0.1);
            backdrop-filter: blur(10px) saturate(150%);
            text-align: center;
            color: #e6eef8;
            overflow-y: auto;
        }

        .estadisticas h1 {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            margin: 0;
            color: #fff;
            text-shadow: 0 3px 18px rgba(0, 0, 0, 0.6);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Contenedor de stats */
        .stats-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* Item individual de stat */
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0, 0, 0, 0.18));
            padding: 12px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

      
        .stat-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 4px;
        }

        .stat-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            text-transform: capitalize;
            letter-spacing: 0.5px;
        }

        .stat-value-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.7);
        }

     
        .stat-bar {
            width: 100%;
            height: 22px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            position: relative;
        }

        /* Relleno de la barra */
        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #6390F0, #5280D0);
            border-radius: 999px;
            transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 15px rgba(99, 144, 240, 0.6) inset;
        }

        /* Texto dentro de la barra de stat */
        .stat-fill .stat-fill-text {
            display: inline-block;
            padding: 0 10px;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 700;
            line-height: 22px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.6);
        }
        .spinner {
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255,255,255,0.2);
            border-top-color: rgba(255,255,255,0.9);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 8px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .spinner.show { opacity: 1; }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* Banner de error */
        .error-banner {
            max-width: 1200px;
            margin: 12px auto;
            padding: 12px 16px;
            background: linear-gradient(90deg, rgba(255,70,85,0.12), rgba(0,0,0,0.2));
            color: #ffdede;
            border: 1px solid rgba(255,70,85,0.18);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            display: none;
        }

        .error-banner.show { display: block; }

        /* Small value badge at right end of stat-row */
        .stat-value-text {
            white-space: nowrap;
            margin-left: 8px;
        }

        /* Moves panel style (center column) */
        .moves-container {
            background: rgba(0,0,0,0.22);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.04);
            backdrop-filter: blur(6px);
            max-height: 240px;
        }
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 1099px) {
            main.contenedor {
                grid-template-columns: 1fr 1fr;
                gap: 24px;
                max-width: 768px;
            }

            .card {
                grid-column: 1 / 2;
                grid-row: 1 / 2;
            }

            .informacion {
                grid-column: 2 / 3;
                grid-row: 1 / 2;
            }

            .estadisticas {
                grid-column: 1 / -1;
                grid-row: 2 / 3;
            }

            header {
                margin-bottom: 40px;
            }

            #logo {
                width: 220px;
            }

            #pokebola {
                width: 70px;
            }
        }

        @media (max-width: 700px) {
            body {
                padding: 15px;
            }

            header {
                flex-direction: column;
                gap: 20px;
                margin-bottom: 30px;
                padding: 12px;
            }

            .header-left {
                flex-direction: column;
                align-items: center;
            }

            .header-right {
                flex-direction: column;
                width: 100%;
                max-width: 100%;
            }

            #logo {
                width: 200px;
            }

            #pokebola {
                width: 60px;
            }

            input[type="text"],
            button {
                width: 100%;
            }

            main.contenedor {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 0 12px 40px;
            }

            .card,
            .informacion,
            .estadisticas {
                grid-column: 1 / -1;
                grid-row: auto;
                min-height: auto;
            }

            .card h1 {
                font-size: 16px;
            }

            #img {
                width: 240px;
                height: 240px;
            }

            .info-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }

            .info-section:nth-child(1),
            .info-section:nth-child(2),
            .info-section:nth-child(3) {
                grid-column: 1 / -1;
                grid-row: auto;
            }

            .section-title {
                font-size: 10px;
            }

            .estadisticas h1 {
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            #logo {
                width: 160px;
            }

            #pokebola {
                width: 50px;
            }

            .card,
            .informacion,
            .estadisticas {
                padding: 16px;
                border-radius: 16px;
            }

            .card h1 {
                font-size: 14px;
            }

            #img {
                width: 200px;
                height: 200px;
            }

            .type-badge,
            .weakness-badge {
                font-size: 11px;
                padding: 6px 12px;
            }

            .move-item {
                font-size: 11px;
                padding: 5px 10px;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="header-left">
            <img id="pokebola" src="img/pokebola.png" alt="Pokébola" loading="lazy">
            <img id="logo" src="img/logo.png" alt="Pokémon Logo" loading="lazy">
        </div>
        <div class="header-right">
            <input id="pok" type="text" placeholder="Escribe el nombre o número de Pokémon...">
            <button id="buscarBtn" onclick="traer()">Buscar <span id="buscarSpinner" class="spinner" aria-hidden="true"></span></button>
            <button id="randomBtn" title="Buscar Pokémon aleatorio" onclick="buscarAleatorio()">Aleatorio <span id="randomSpinner" class="spinner" aria-hidden="true"></span></button>
        </div>
    </header>

    <!-- Banner de error (oculto por defecto) -->
    <div id="errorBanner" role="alert" aria-live="assertive" class="error-banner" hidden></div>


    <main class="contenedor">
        <section class="card">
            <h1 id="nombre"></h1>
            <img id="img" alt="Imagen de Pokémon" loading="lazy">
            <div class="meta">
                <span id="altura"></span>
                <span id="peso"></span>
            </div>
        </section>

        <section class="informacion">
            <div class="center-info">
                <div class="big-id" id="bigId"></div>
                <div class="center-subtitle">Tipos del pokemon</div>
            </div>
            <div class="info-grid">
                <div class="info-section">
                    <h2 class="section-title">Tipos</h2>
                    <div id="tipos"></div>
                </div>

                <div class="info-section">
                    <h2 class="section-title">Movimientos</h2>
                    <div id="movimientos" class="moves-container"></div>
                </div>

                <div class="info-section">
                    <h2 class="section-title">Debilidades</h2>
                    <div id="debilidades"></div>
                </div>
            </div>
        </section>

        <section class="estadisticas">
            <h1>Estadísticas</h1>
            <div class="stats-container" id="statsContainer"></div>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // Colores de tipos de Pokémon
        const typeColors = {
            normal: '#A8A77A',
            fire: '#EE8130',
            water: '#6390F0',
            electric: '#F7D02C',
            grass: '#7AC74C',
            ice: '#96D9D6',
            fighting: '#C22E28',
            poison: '#A33EA1',
            ground: '#E2BF65',
            flying: '#A98FF3',
            psychic: '#F95587',
            bug: '#A6B91A',
            rock: '#B6A136',
            ghost: '#735797',
            dragon: '#6F35FC',
            dark: '#705746',
            steel: '#B7B7CE',
            fairy: '#D685AD'
        };

        function hexToRgb(hex) {
            const clean = hex.replace('#', '');
            const bigint = parseInt(clean, 16);
            return [(bigint >> 16) & 255, (bigint >> 8) & 255, bigint & 255];
        }

        function getContrastColor(hex) {
            const [r, g, b] = hexToRgb(hex);
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.6 ? '#071022' : '#ffffff';
        }

       
        function darken(hex, amount = 0.12) {
            const [r, g, b] = hexToRgb(hex);
            const nr = Math.max(0, Math.floor(r * (1 - amount)));
            const ng = Math.max(0, Math.floor(g * (1 - amount)));
            const nb = Math.max(0, Math.floor(b * (1 - amount)));
            return `rgb(${nr}, ${ng}, ${nb})`;
        }

        
        function hexToRgba(hex, alpha = 1) {
            const [r, g, b] = hexToRgb(hex);
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        // Placeholder SVG data URL cuando no hay imagen
        const placeholderSvg = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400"><rect width="100%" height="100%" fill="%23888"/><text x="50%" y="50%" font-size="20" text-anchor="middle" fill="%23fff">No Image</text></svg>';

        // UI helpers: loading state and error banner
        function setLoading(isLoading) {
            const buscarBtn = document.getElementById('buscarBtn');
            const randomBtn = document.getElementById('randomBtn');
            const buscarSpinner = document.getElementById('buscarSpinner');
            const randomSpinner = document.getElementById('randomSpinner');

            if (buscarBtn) buscarBtn.disabled = isLoading;
            if (randomBtn) randomBtn.disabled = isLoading;

            if (buscarSpinner) {
                buscarSpinner.classList.toggle('show', isLoading);
                buscarSpinner.setAttribute('aria-hidden', (!isLoading).toString());
            }
            if (randomSpinner) {
                randomSpinner.classList.toggle('show', isLoading);
                randomSpinner.setAttribute('aria-hidden', (!isLoading).toString());
            }

          
            const main = document.querySelector('main.contenedor');
            if (main) main.setAttribute('aria-busy', isLoading ? 'true' : 'false');
        }

        function showError(message) {
            const banner = document.getElementById('errorBanner');
            if (!banner) return;
            banner.textContent = message;
            banner.hidden = false;
            banner.classList.add('show');
            // auto-hide after 4s
            setTimeout(() => { banner.classList.remove('show'); banner.hidden = true; }, 4000);
        }

        function clearError() {
            const banner = document.getElementById('errorBanner');
            if (!banner) return;
            banner.textContent = '';
            banner.hidden = true;
            banner.classList.remove('show');
        }

        // Función principal para buscar Pokémon
        async function traer(idOrName = null) {
            clearError();
            setLoading(true);
            let pokemon;
            if (idOrName) {
                pokemon = idOrName;
            } else {
                pokemon = document.getElementById("pok").value.toLowerCase().trim();
            }

            if (!pokemon) {
                showError('Por favor, ingresa un nombre o número de Pokémon');
                setLoading(false);
                return;
            }

            try {
                let res = await axios.get(`https://pokeapi.co/api/v2/pokemon/${pokemon}`);
                console.log(res);

                // Información básica
                document.getElementById("nombre").textContent = res.data.name.toUpperCase();
                const imgEl = document.getElementById("img");
                const sprite = (res.data.sprites && res.data.sprites.other && res.data.sprites.other['official-artwork'] && res.data.sprites.other['official-artwork'].front_default) || res.data.sprites.front_default || placeholderSvg;
                if (imgEl) imgEl.src = sprite;
                document.getElementById("altura").textContent = `Altura: ${res.data.height / 10} m`;
                document.getElementById("peso").textContent = `Peso: ${res.data.weight / 10} kg`;
                const bigIdEl = document.getElementById('bigId');
                if (bigIdEl) bigIdEl.textContent = `#${res.data.id.toString().padStart(3, '0')}`;

                // TIPOS
                const tiposDiv = document.getElementById("tipos");
                tiposDiv.innerHTML = '';
                const typesList = res.data.types.map(t => t.type.name);
                const colors = typesList.map(name => typeColors[name] || '#999999');

                typesList.forEach((name, idx) => {
                    const base = colors[idx];
                    const darker = darken(base, 0.14);
                    const badge = document.createElement('span');
                    badge.className = 'type-badge';
                    badge.textContent = name;
                    badge.style.background = `linear-gradient(135deg, ${base}, ${darker})`;
                    badge.style.color = getContrastColor(base);
                    tiposDiv.appendChild(badge);
                });

                // MOVIMIENTOS
                const movimientosDiv = document.getElementById("movimientos");
                movimientosDiv.innerHTML = '';
                const movesToShow = res.data.moves.slice(0, 20);

                if (movesToShow.length > 0) {
                    movesToShow.forEach(m => {
                        const moveName = m.move.name.replace(/-/g, ' ');
                        const item = document.createElement('span');
                        item.className = 'move-item';
                        item.textContent = moveName;
                        movimientosDiv.appendChild(item);
                    });
                } else {
                    movimientosDiv.textContent = 'No hay movimientos disponibles.';
                }

               
                const debilidadesSet = new Set();
                for (const tipo of res.data.types) {
                    const typeRes = await axios.get(tipo.type.url);
                    const damageFrom = typeRes.data.damage_relations.double_damage_from;
                    damageFrom.forEach(t => debilidadesSet.add(t.name));
                }

                const debilidadesDiv = document.getElementById("debilidades");
                debilidadesDiv.innerHTML = '';
                const debilidadesList = Array.from(debilidadesSet);

                debilidadesList.forEach(name => {
                    const base = typeColors[name] || '#999999';
                    const darker = darken(base, 0.14);
                    const badge = document.createElement('span');
                    badge.className = 'weakness-badge';
                    badge.textContent = name;
                    badge.style.background = `linear-gradient(135deg, ${base}, ${darker})`;
                    badge.style.color = getContrastColor(base);
                    debilidadesDiv.appendChild(badge);
                });

                // FONDO DE LA CARD BASADO EN TIPO
                const card = document.querySelector('.card');

                // Cambiar el fondo de la página según el/los tipo(s) del Pokémon
                try {
                    document.body.style.transition = 'background-image 0.6s ease, background-color 0.6s ease';

                    if (colors.length === 1) {
                        const top = hexToRgba(colors[0], 0.25);
                        const bottom = darken(colors[0], 0.35);
                        document.body.style.backgroundImage = `linear-gradient(180deg, ${top}, ${bottom}), url('img/fondo.jpg')`;
                    } else {
                        const gradientParts = colors.slice(0, 3).map(c => hexToRgba(c, 0.28)).join(', ');
                        document.body.style.backgroundImage = `linear-gradient(135deg, ${gradientParts}), url('img/fondo.jpg')`;
                    }
                } catch (e) {
                    console.warn('No fue posible actualizar el fondo dinámico:', e);
                }

                if (colors.length === 1) {
                    const b = colors[0];
                    card.style.background = `linear-gradient(135deg, ${b}, ${darken(b, 0.25)})`;
                } else {
                    const gradient = colors.join(', ');
                    card.style.background = `linear-gradient(135deg, ${gradient})`;
                }

                const textColor = getContrastColor(colors[0]);
                card.style.color = textColor;

                const glow = `0 20px 50px rgba(2,6,23,0.7), 0 0 40px ${hexToRgba(colors[0], 0.25)}`;
                card.style.boxShadow = glow;

                // ESTADÍSTICAS
                const statsContainer = document.getElementById("statsContainer");
                statsContainer.innerHTML = '';

                res.data.stats.forEach(stat => {
                    const statName = stat.stat.name;
                    const statValue = stat.base_stat;
                    const maxStat = 255;

                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';

                    const label = document.createElement('span');
                    label.className = 'stat-label';
                    label.textContent = statName.replace(/-/g, ' ');

                    const header = document.createElement('div');
                    header.className = 'stat-header';

                    const value = document.createElement('span');
                    value.className = 'stat-value-text';
                    value.textContent = `${statValue} / ${maxStat}`;

                    header.appendChild(label);
                    header.appendChild(value);

                    const bar = document.createElement('div');
                    bar.className = 'stat-bar';

                    const fill = document.createElement('div');
                    fill.className = 'stat-fill';
                    const fillPercent = Math.max(2, (statValue / maxStat) * 100); // minimum visible
                    fill.style.width = `${fillPercent}%`;

                    // Aplicar colores del tipo a las barras
                    if (colors.length === 1) {
                        const base = colors[0];
                        const darker = darken(base, 0.25);
                        fill.style.background = `linear-gradient(90deg, ${base}, ${darker})`;
                        fill.style.boxShadow = `0 0 15px ${hexToRgba(base, 0.8)} inset`;
                    } else {
                        const gradientColors = colors.slice(0, 3).join(', ');
                        fill.style.background = `linear-gradient(90deg, ${gradientColors})`;
                        fill.style.boxShadow = `0 0 15px ${hexToRgba(colors[0], 0.6)} inset`;
                    }

                    // Añadir texto dentro de la barra
                    const fillText = document.createElement('span');
                    fillText.className = 'stat-fill-text';
                    fillText.textContent = `${statValue} / ${maxStat}`;
                    // Contraste de color del texto según primer color
                    try { fillText.style.color = getContrastColor(colors[0] || '#6390F0'); } catch (e) {}
                    fill.appendChild(fillText);

                    bar.appendChild(fill);
                    statItem.appendChild(header);
                    statItem.appendChild(bar);
                    statsContainer.appendChild(statItem);
                });
            } catch (error) {
                console.error("Error buscando Pokémon:", error);
                showError("Pokémon no encontrado. Intenta con otro nombre o número.");
                
                // Limpiar información
                document.getElementById("nombre").textContent = "";
                const imgEl = document.getElementById("img"); if (imgEl) imgEl.src = placeholderSvg;
                document.getElementById("altura").textContent = "";
                document.getElementById("peso").textContent = "";
                const bigIdReset = document.getElementById('bigId');
                if (bigIdReset) bigIdReset.textContent = '';
                document.getElementById("tipos").innerHTML = "";
                document.getElementById("movimientos").innerHTML = "";
                document.getElementById("debilidades").innerHTML = "";
                document.getElementById("statsContainer").innerHTML = "";
                
                // Resetear card
                const card = document.querySelector('.card');
                if (card) {
                    card.style.background = 'linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04))';
                    card.style.boxShadow = '0 20px 50px rgba(2, 6, 23, 0.7), 0 0 40px rgba(255, 70, 85, 0.1)';
                }
            } finally {
                setLoading(false);
            }
        }

        // Permitir búsqueda con Enter
        document.getElementById('pok').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                traer();
            }
        });

        // Cargar Pikachu por defecto al iniciar
        window.addEventListener('load', function() {
            traer('pikachu');
        });

        // Buscar un Pokémon aleatorio
        function buscarAleatorio() {
            const maxPokemon = 1010; // actualiza si se lanzan más generaciones
            const id = Math.floor(Math.random() * maxPokemon) + 1;
            // Mostrar el id en el input para referencia del usuario
            const input = document.getElementById('pok');
            if (input) input.value = id;
            traer(id.toString());
        }
    </script>
</body>

</html>




